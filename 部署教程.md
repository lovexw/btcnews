# BTC 新闻聚合器 - 5分钟快速部署教程

本教程将帮助你在 5 分钟内完成项目部署！

## 🎯 项目配置信息

- **项目名称**：BTC新闻聚合器2025
- **数据源**：金色财经
- **起始ID**：488209
- **更新频率**：每30分钟
- **监控关键词**：BTC, bitcoin, 中国, 中本聪, 特朗普, 美联储
- **KV数据库名称**：btcnews2025
- **KV数据库ID**：6514ec5dffd14610b39e8a85c0309496

## 📦 第一步：安装依赖（1分钟）

打开终端，进入项目目录：

```bash
# 安装项目依赖
npm install

# 全局安装 wrangler（如果还没安装）
npm install -g wrangler
```

## 🔐 第二步：登录 Cloudflare（1分钟）

```bash
npm run login
```

浏览器会自动打开 Cloudflare 授权页面，点击 **Allow** 授权即可。

## 🗄️ 第三步：确认 KV 配置（1分钟）

### 选项A：使用已有的 KV 命名空间（推荐）

如果 KV ID `6514ec5dffd14610b39e8a85c0309496` 已经创建，直接跳过此步骤。

### 选项B：创建新的 KV 命名空间

如果需要创建新的 KV：

```bash
# 创建 KV 命名空间
wrangler kv:namespace create btcnews2025
```

记录返回的 ID，并更新 `wrangler.toml` 中的配置：

```toml
[[kv_namespaces]]
binding = "BTC_NEWS_KV"
id = "你的新KV_ID"  # 替换这里
```

## 🚀 第四步：部署到生产环境（1分钟）

```bash
npm run deploy
```

等待几秒钟，你会看到类似输出：

```
✨ Success!
Published btc-news-aggregator-2025
  https://btc-news-aggregator-2025.your-account.workers.dev
```

**恭喜！部署完成！** 🎉

## ✅ 第五步：验证部署（1分钟）

### 1. 打开部署的网址

复制上一步返回的 URL，在浏览器中打开。

### 2. 手动触发第一次抓取

访问：`https://你的worker地址/api/refresh`

等待几秒钟后，再次刷新首页，应该能看到新闻了！

### 3. 查看系统状态

访问：`https://你的worker地址/api/status`

应该显示类似信息：

```json
{
  "totalNews": 10,
  "lastProcessedId": 488220,
  "serverTime": "2025-01-15 14:30",
  "cronStatus": "正常",
  "version": "3.0.0-30min-488209"
}
```

## 🎊 完成！

你的 BTC 新闻聚合器已经成功部署并运行了！

系统会每 30 分钟自动抓取一次新闻，你可以：

- 📱 将网址添加到手机主屏幕
- 🔖 收藏到浏览器书签
- 📢 分享给朋友

---

## 🔧 常用命令速查

```bash
# 本地开发
npm run dev

# 部署到生产
npm run deploy

# 查看实时日志
npm run tail

# 重新登录
npm run login
```

---

## 📊 API 接口速查

| 接口 | 地址 | 说明 |
|------|------|------|
| 首页 | `/` | 查看新闻列表 |
| 新闻API | `/api/news` | 获取JSON格式新闻 |
| 手动刷新 | `/api/refresh` | 立即抓取新闻 |
| 系统状态 | `/api/status` | 查看系统状态 |
| 重置系统 | `/api/reset?id=488209` | 重置起始ID |

---

## 🆘 遇到问题？

### 问题1：部署失败，提示认证错误

```bash
wrangler logout
wrangler login
npm run deploy
```

### 问题2：页面空白，没有新闻

访问 `/api/refresh` 手动触发抓取，等待几秒后刷新首页。

### 问题3：想修改关键词

编辑 `src/index.js`，找到 `isBTCRelated` 方法中的 `keywords` 数组，添加或修改关键词后重新部署。

### 问题4：想修改更新频率

编辑 `wrangler.toml`，修改 `crons` 配置：

```toml
# 每15分钟
crons = ["*/15 * * * *"]

# 每小时
crons = ["0 * * * *"]
```

修改后重新部署。

---

## 📖 更多帮助

- 详细部署文档：查看 `DEPLOYMENT.md`
- 项目说明：查看 `README.md`
- Cloudflare 文档：https://developers.cloudflare.com/workers/

---

**祝你使用愉快！** 🚀✨
